# üõ°Ô∏è SIEM Lab: Attack Detection & Analysis Using Splunk

## Overview
This project demonstrates hands-on experience using **Splunk Enterprise as a SIEM** to detect, analyze, and respond to common attacker techniques on a Linux host.  
Attack activity was simulated from a Kali Linux machine against an Ubuntu server, with logs ingested and analyzed in Splunk.

The lab covers the full attack lifecycle:
- Initial access
- Credential abuse
- Privilege escalation
- Malware execution
- Persistence
- Account backdooring

---

## Lab Architecture

**Attacker Machine:** Kali Linux  
**Target Machine:** Ubuntu Server  
**SIEM:** Splunk Enterprise  

**Log Sources:**
- `/var/log/auth.log`
- `/var/log/audit/audit.log`
- `/var/log/cron`

**Splunk Configuration:**
- Splunk Universal Forwarder on Ubuntu
- Index: `linux`
- Sourcetypes: `linux_secure`, `linux_audit`, `linux_cron`

---

## Attack Simulation Playbook, Detection, Alerts & Dashboards

---

## 1Ô∏è‚É£ SSH Brute-Force Attack (Failed Logins)

### Attack Description
Simulated a credential brute-force attack using repeated SSH login attempts.

### Attack Execution (Kali)
```bash
for i in {1..20}; do ssh fakeuser@<UBUNTU_IP>; done
or

hydra -l fakeuser -P /usr/share/wordlists/rockyou.txt ssh://<UBUNTU_IP>
Log Source
/var/log/auth.log

Splunk Detection Query
index=linux source="/var/log/auth.log" "Failed password"
| stats count by src_ip, user
| where count > 5
Splunk Alert
Alert Name: SSH Brute Force Detected
Trigger Condition: More than 5 failed logins within 5 minutes
Severity: High
Action: SOC notification / Incident creation

index=linux "Failed password"
| bucket _time span=5m
| stats count by _time src_ip
| where count > 5
Dashboard Panel
Panel Name: SSH Failed Login Attempts

Visualization: Bar Chart

X-axis: Source IP

Y-axis: Failed login count

MITRE ATT&CK
T1110 ‚Äì Brute Force

2Ô∏è‚É£ Successful Login After Brute Force
Attack Description
A valid login occurred after multiple failed attempts, simulating account compromise.

Attack Execution (Kali)
ssh validuser@<UBUNTU_IP>
Splunk Detection Query
index=linux source="/var/log/auth.log" "Accepted password"
| table _time user src_ip
Correlation Alert
Alert Name: Successful Login After Brute Force
Logic: Successful login from IP previously flagged for brute force
Severity: Critical

index=linux
| transaction src_ip maxspan=10m
| search "Failed password" OR "Accepted password"
Dashboard Panel
Panel Name: Authentication Timeline

Visualization: Timechart

Tracks failed vs successful logins

MITRE ATT&CK
T1078 ‚Äì Valid Accounts

3Ô∏è‚É£ Privilege Escalation (Sudo Abuse)
Attack Description
The attacker escalated privileges using sudo.

Attack Execution (Ubuntu)
sudo su
or

sudo cat /etc/shadow
Log Sources
/var/log/auth.log

/var/log/audit/audit.log

Splunk Detection Query
index=linux ("sudo" OR "/etc/shadow")
| table _time user command
Splunk Alert
Alert Name: Privilege Escalation Detected
Trigger: Sudo usage by non-admin user
Severity: High

Dashboard Panel
Panel Name: Privileged Command Usage

Visualization: Table

Columns: User, Command, Time

MITRE ATT&CK
T1548 ‚Äì Abuse Elevation Control Mechanism

4Ô∏è‚É£ Suspicious Execution from /tmp
Attack Description
Executed a script from /tmp, a common attacker technique.

Attack Execution (Ubuntu)
cd /tmp
echo -e '#!/bin/bash\necho owned' > evil.sh
chmod +x evil.sh
./evil.sh
Splunk Detection Query
index=linux "/tmp" "EXECVE"
| table _time user exe
Splunk Alert
Alert Name: Suspicious Execution from /tmp
Severity: High
Trigger: Executable run from world-writable directory

Dashboard Panel
Panel Name: Suspicious Process Execution

Visualization: Table

Focus: Non-standard execution paths

MITRE ATT&CK
T1059 ‚Äì Command and Scripting Interpreter

5Ô∏è‚É£ Persistence via Cron Job
Attack Description
Persistence established using a cron job.

Attack Execution (Ubuntu)
crontab -e
Added:

*/5 * * * * /bin/bash -c 'echo backdoor >> /tmp/persist.log'
Splunk Detection Query
index=linux ("CRON" OR "crontab")
| table _time user command
Splunk Alert
Alert Name: Unauthorized Cron Job Created
Severity: Medium

Dashboard Panel
Panel Name: Scheduled Task Changes

Visualization: Table

Tracks new and modified cron jobs

MITRE ATT&CK
T1053 ‚Äì Scheduled Task/Job

6Ô∏è‚É£ Backdoor User with Sudo Privileges
Attack Description
Created a new user and added it to the sudo group.

Attack Execution (Ubuntu)
sudo useradd attacker
sudo usermod -aG sudo attacker
Splunk Detection Query
index=linux ("useradd" OR "usermod")
| table _time user command
Splunk Alert
Alert Name: New Privileged User Created
Severity: Critical

Dashboard Panel
Panel Name: User & Group Changes

Visualization: Table

Tracks account creation and privilege changes

MITRE ATT&CK
T1136 ‚Äì Create Account

SOC Correlation & Incident Summary
Splunk correlation rules identified:

Brute-force ‚Üí successful login

Privilege escalation

Malware execution

Persistence mechanisms

Account backdoor creation

This activity represents a complete attack chain, from initial access to long-term persistence.

Skills Demonstrated
SIEM engineering with Splunk

Log ingestion & normalization

Alert creation & tuning

Dashboard design

MITRE ATT&CK mapping

Incident investigation

Blue team detection strategy

Future Improvements
SOAR integration

Risk-based alerting

Automated response actions

Threat intelligence enrichment

Multi-host correlation

